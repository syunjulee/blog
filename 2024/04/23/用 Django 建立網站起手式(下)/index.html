<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>用 Django 建立網站起手式(下) | AA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
<link rel="stylesheet" href="../../../../css/style.css">

  
    
<link rel="stylesheet" href="../../../../css/highlight.css">

  
  <meta name="description" content="下篇來記錄子目錄的設定、前端環境的建立和 model 資料庫的連結與處理，整體流程上來說，通常會以 urls -&gt; views -&gt; model -&gt; render templates 來進行。">
<meta property="og:type" content="article">
<meta property="og:title" content="用 Django 建立網站起手式(下)">
<meta property="og:url" content="https://syunjulee.github.io/blog/2024/04/23/%E7%94%A8%20Django%20%E5%BB%BA%E7%AB%8B%E7%B6%B2%E7%AB%99%E8%B5%B7%E6%89%8B%E5%BC%8F(%E4%B8%8B)/index.html">
<meta property="og:site_name" content="AA">
<meta property="og:description" content="下篇來記錄子目錄的設定、前端環境的建立和 model 資料庫的連結與處理，整體流程上來說，通常會以 urls -&gt; views -&gt; model -&gt; render templates 來進行。">
<meta property="og:locale" content="zh_TW">
<meta property="article:published_time" content="2024-04-23T01:50:05.000Z">
<meta property="article:modified_time" content="2024-05-03T06:01:12.930Z">
<meta property="article:author" content="末次">
<meta property="article:tag" content="Django">
<meta property="article:tag" content="CRUD">
<meta property="article:tag" content="Tailwind">
<meta name="twitter:card" content="summary"><meta name="generator" content="Hexo 7.1.1"></head>

<body>
  <div id="wrapper">
    <header id="header">
  <h1 id="title">
    <a href="../../../../index.html">AA</a>
  </h1>
  <nav>
    
    
      
      <a class="nav-link" href="../../../../index.html">Home</a>
    
      
        <span class="nav-spacer">×</span>
      
      <a class="nav-link" href="../../../../archives">Archives</a>
    
    
  </nav>
</header>

    <div id="content">
      <article id="post-用 Django 建立網站起手式(下)" class="article article-type-post" itemprop="blogPost" itemscope>
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h2 class="article-title" itemprop="headline name">
      用 Django 建立網站起手式(下)
    </h2>
  


        <div class="article-meta">
          <time class="article-date" datetime="2024-04-23T01:50:05.000Z" itemprop="datePublished">2024-4-23</time>

          
            × <span class="article-word-count">3.8k 字</span>
            <!-- 
            × <span class="article-time-to-read">17 mins</span>
             -->
          
        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
      
        <p>下篇來記錄子目錄的設定、前端環境的建立和 model 資料庫的連結與處理，整體流程上來說，通常會以 <code>urls -&gt; views -&gt; model -&gt; render templates</code> 來進行。</p>
<span id="more"></span>

<h2 id="專案子目錄的建立"><a href="#專案子目錄的建立" class="headerlink" title="專案子目錄的建立"></a>專案子目錄的建立</h2><p>一個子目錄是一個資料夾，也可視為一個模組，必須包含 <code>urls.py</code> 和 <code>views.py</code> 檔案，<code>urls.py</code> 是用來管理整個模組的頁面路徑結構，而 <code>views.py</code> 則是負責渲染程式到頁面的 Python 函式模組。為了每個子目錄連結都可以在全站中來去自如，需要將資料夾模組化，所以要建立 <code>__init__.py</code> 檔案。</p>
<h3 id="在專案資料夾內新增子目錄"><a href="#在專案資料夾內新增子目錄" class="headerlink" title="在專案資料夾內新增子目錄"></a>在專案資料夾內新增子目錄</h3><p>除了自己手動新建資料夾之外，Django 也有指令來創建：</p>
<ul>
<li><code>$ django-admin startproapp 資料夾名稱</code></li>
<li><code>$ python manage.py startapp 資料夾名稱</code>: 這款較可確保執行環境的穩定</li>
</ul>
<p>  每一個透過 Django startapp 指令生成的資料夾，都可以當作一個應用程式，功能比較完整，不用再自己刻，但是接下來兩個檔案，就必須自己建立了XD。</p>
<ul>
<li><code>urls.py</code><br>  經過上篇的介紹，就會知道這個檔案是用來管理入口頁的結構和路徑，而且順序很重要。  <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">app_name = <span class="string">&#x27;子目錄&#x27;</span></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">  path(<span class="string">&#x27;&#x27;</span>, views.home, name=<span class="string">&#x27;home&#x27;</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
<li><code>views.py</code><br>  而 views 則是負責渲染路徑的程式。  <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>(<span class="params">req</span>):</span><br><span class="line">  <span class="keyword">return</span> render(req, <span class="string">&#x27;子目錄/index.html&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="前端環境的設定與載入"><a href="#前端環境的設定與載入" class="headerlink" title="前端環境的設定與載入"></a>前端環境的設定與載入</h2><p>若是想要直接在專案資料夾裡處理 CSS，在上篇有提到可以在專案資料夾下建立 static 資料夾，專門存放靜態檔案，例如 CSS、JS 和 圖片。若不使用套件，就可以很單純的加上 CSS 檔案並連結到樣版 html。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% load static %&#125;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>&#123;% block title %&#125;網站名稱&#123;% endblock %&#125;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &quot;</span><span class="attr">styles</span>/<span class="attr">style.css</span>&quot; %&#125;&quot;&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  &#123;% block content %&#125;&#123;% endblock %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>詳細的前端工具載入與設定會在 JS 打包篇詳解～</p>
<hr>
<h2 id="在-Django-與資料庫連結"><a href="#在-Django-與資料庫連結" class="headerlink" title="在 Django 與資料庫連結"></a>在 Django 與資料庫連結</h2><p>在 html 製作要與資料庫連動的表單(form)，有兩個跟資料庫有關的屬性：action 和 method</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;把資料送去哪裡&quot;</span> <span class="attr">method</span>=<span class="string">&quot;用什麼方法送&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>action 的值是一個網頁路徑，是指這個表單的內容在啟動觸發器時，會把資料送去哪裡處理；method 的值則是選擇用什麼方法送去，目前 html 只有兩種方法：GET 和 POST。</p>
<ul>
<li>GET: 網址會把輸入資料顯示在網址上，稱作 QueryString，用在查詢或搜尋比較好</li>
<li>POST: 反之，網址會把輸入資料隱藏，資料會在 request 物件裡的 body，撈資料也是從這裡，但至少在前台不會顯示，像是新增、更新和刪除等操作用 POST 會較合適。</li>
</ul>
<hr>
<h3 id="model-py-生成資料庫"><a href="#model-py-生成資料庫" class="headerlink" title="model.py 生成資料庫"></a><code>model.py</code> 生成資料庫</h3><p>要先在 Django 專案資料夾裡生成資料庫，就可以直接在專案資料夾裡生成操作資料表(table)。用 ORM(Object-Relationship Mapping 物件關聯性對照)寫入資料或讀取在子目錄下的 model.py。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Name</span>(models.Model):</span><br><span class="line">    name = models.CharField(<span class="built_in">max</span>-length=<span class="number">100</span>)</span><br><span class="line">    description = models.TextField(<span class="built_in">max</span>-length=<span class="number">200</span>)</span><br><span class="line">    create_at = models.DateTimeField(auto_now_add=<span class="literal">True</span>)</span><br><span class="line">    updated_at = models.DateTimeField(auto_now=<span class="literal">True</span>)</span><br><span class="line">    .</span><br><span class="line">    .</span><br><span class="line">    etc.</span><br></pre></td></tr></table></figure>
<p>建完模組後，記得也要去 <code>settings.py</code> 註冊 APP。<br>增加完之後用 Django 指令生成資料表和欄位：</p>
<figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python manage.py makemigrations</span><br></pre></td></tr></table></figure>
<p>生成一個 migrations&#x2F;0001.initial.py 給子目錄，但目前只是生成，還要去 Apply 它，所以</p>
<figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python manage.py migrate</span><br></pre></td></tr></table></figure>
<p>就會產生從 <code>model.py</code> 寫好的模組建成資料庫檔案，而 table 的名稱就會叫做 <code>子目錄_class名稱</code>。若要更新修改模組檔案，還是要再跑上述兩個指令。另外，還可以指定要回到哪條 migration，但是該條所做的內容也會跟著消失，雖然有版控的感覺，但倒退嚕還是會有一定的風險在，雖然再執行一次 <code>migrate</code> 資料結構會回來，但內容卻會永遠消失。</p>
<hr>
<h2 id="CRUD"><a href="#CRUD" class="headerlink" title="CRUD"></a>CRUD</h2><p>接下來開始資料庫最基本的操作，就是 CRUD，分別是 Create 新增創建、Read 查詢搜尋顯示、Update 更新資料、Delete 刪除資料。以下是在 Django 框架下操作 CRUD 的練習和心得，在 Django 操作 CRUD，必須同時處理三個檔案，分別是 <code>urls.py</code>、<code>views.py</code> 和 <code>html</code>，那我們就繼續看下去～😄</p>
<hr>
<h3 id="Create-新增"><a href="#Create-新增" class="headerlink" title="Create 新增"></a>Create 新增</h3><ul>
<li><code>urls.py</code>: 新增路徑<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">app_name = <span class="string">&#x27;子目錄&#x27;</span></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&quot;&quot;</span>, views.home, name=<span class="string">&quot;index&quot;</span>) <span class="comment"># 子目錄首頁</span></span><br><span class="line">    path(<span class="string">&quot;new&quot;</span>, views.new, name=<span class="string">&quot;new&quot;</span>) <span class="comment"># 要輸入資料的頁面</span></span><br><span class="line">    path(<span class="string">&quot;add&quot;</span>, views.create, name=<span class="string">&quot;add&quot;</span>) <span class="comment"># 寫入模組</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
<li><code>views.py</code>: 渲染路徑和程式<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, redirect <span class="comment"># 渲染路徑、轉址兼解讀路徑</span></span><br><span class="line"><span class="keyword">from</span> django.views.decorators.http <span class="keyword">import</span> require_POST <span class="comment"># 判斷是不是 POST</span></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> <span class="keyword">class</span>名稱 <span class="comment"># 從同家的 model 取 class </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 要輸入資料的頁面</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">req</span>):</span><br><span class="line">    <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/new.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 寫入資料庫</span></span><br><span class="line"><span class="meta">@require_POST</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">req</span>):</span><br><span class="line">    變數_單 = <span class="keyword">class</span>名稱(</span><br><span class="line">        name=req.POST[<span class="string">&quot;name&quot;</span>],</span><br><span class="line">        description=req.POST[<span class="string">&quot;description&quot;</span>]</span><br><span class="line">    )</span><br><span class="line">    變數_單.save()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;root&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li><code>new.html</code>: 渲染到輸入資料的頁面<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&#123;% url &#x27;子目錄:add&#x27; %&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 使用 POST 方法時的安全驗證機制 --&gt;</span></span><br><span class="line">	&#123;% csrf_token %&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;name&quot;</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;name&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;description&quot;</span>&gt;</span>簡介<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">&quot;description&quot;</span> <span class="attr">name</span>=<span class="string">&quot;description&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">		.</span><br><span class="line">		.</span><br><span class="line">		etc.</span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;新增&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="Read-查詢"><a href="#Read-查詢" class="headerlink" title="Read 查詢"></a>Read 查詢</h3><p>查詢有兩件事要做：</p>
<ol>
<li>在子目錄首頁檢視總列表(index)</li>
<li>點擊總列表內容後會連到詳細資料頁面去(show)</li>
</ol>
<hr>
<p>要在子目錄的 index.html 中列出清單，會用 <code>class.object.all()</code> 來列出：</p>
<ul>
<li><code>views.py</code>: 渲染路徑和程式<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, redirect <span class="comment"># 渲染路徑、轉址兼解讀路徑</span></span><br><span class="line"><span class="keyword">from</span> django.views.decorators.http <span class="keyword">import</span> require_POST <span class="comment"># 判斷是不是 POST</span></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> <span class="keyword">class</span>名稱 <span class="comment"># 從同家的 model.py 取 class </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 要列出總清單的頁面</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>(<span class="params">req</span>):</span><br><span class="line">    變數_複 = <span class="keyword">class</span>名稱.objects.<span class="built_in">all</span>()</span><br><span class="line">    <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/index.html&quot;</span>, &#123;<span class="string">&quot;key&quot;</span>: 變數_複&#125;)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 要輸入資料的頁面</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">req</span>):</span><br><span class="line">    <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/new.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 寫入資料庫</span></span><br><span class="line"><span class="meta">@require_POST</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">req</span>):</span><br><span class="line">    變數_單 = <span class="keyword">class</span>名稱(</span><br><span class="line">        name=req.POST[<span class="string">&quot;name&quot;</span>],</span><br><span class="line">        description=req.POST[<span class="string">&quot;description&quot;</span>]</span><br><span class="line">    )</span><br><span class="line">    變數_單.save()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;root&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li><code>index.html</code>: 渲染到要列出總清單的頁面<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>總列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 前往新增的頁面 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% url &#x27;子目錄:new&#x27; %&#125;&quot;</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">a</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- 用迴圈渲染出總列表 --&gt;</span></span><br><span class="line">&#123;% for 變數_單 in 變數_複 %&#125;</span><br><span class="line">	<span class="comment">&lt;!-- 設計卡片囉～ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 渲染出名稱 --&gt;</span></span><br><span class="line">		&#123;&#123; 變數_單.name &#125;&#125; </span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<p>第二個是點擊內容會連去該筆資料的詳細頁面，網址的目標設定為 <code>子目錄/編號</code>：</p>
<ul>
<li><code>urls.py</code>: 新增路徑<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">app_name = <span class="string">&#x27;子目錄&#x27;</span></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&quot;&quot;</span>, views.home, name=<span class="string">&quot;index&quot;</span>) <span class="comment"># 子目錄首頁</span></span><br><span class="line">    path(<span class="string">&quot;new&quot;</span>, views.new, name=<span class="string">&quot;new&quot;</span>) <span class="comment"># 要輸入資料的頁面</span></span><br><span class="line">    path(<span class="string">&quot;add&quot;</span>, views.create, name=<span class="string">&quot;add&quot;</span>) <span class="comment"># 寫入模組</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 網址應該是一個變動的變數，所以要用&lt;&gt;包住，而且順序非常重要，讓比對性的變數網址放在最後，才不會讓其他網址變成變數的值</span></span><br><span class="line">    path(<span class="string">&quot;&lt;id&gt;&quot;</span>, views.show, name=<span class="string">&quot;show&quot;</span>) <span class="comment"># 單筆資料的詳細頁面</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
<li><code>views.py</code>: 渲染路徑和程式<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, redirect get_object_or_404 <span class="comment"># 渲染路徑、轉址兼解讀路徑、判斷有無值不然就404</span></span><br><span class="line"><span class="keyword">from</span> django.views.decorators.http <span class="keyword">import</span> require_POST <span class="comment"># 判斷是不是 POST</span></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> <span class="keyword">class</span>名稱 <span class="comment"># 從同家的 model.py 取 class </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 要列出總清單的頁面</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>(<span class="params">req</span>):</span><br><span class="line">    變數_複 = <span class="keyword">class</span>名稱.objects.<span class="built_in">all</span>()</span><br><span class="line">    <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/index.html&quot;</span>, &#123;<span class="string">&quot;key&quot;</span>: 變數_複&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 要列出單筆資料詳細內容的頁面</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">req, <span class="built_in">id</span></span>):</span><br><span class="line">    <span class="comment"># 為了防止使用者在 QueryString 自己亂找編號，要做一個防止措施</span></span><br><span class="line">    變數_單 = get_object_or_404(<span class="keyword">class</span>名稱, pk=<span class="built_in">id</span>) <span class="comment"># 主鍵是 id</span></span><br><span class="line">    <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/show.html&quot;</span>, &#123;<span class="string">&quot;key&quot;</span>: 變數_單&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 要輸入資料的頁面</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">req</span>):</span><br><span class="line">    <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/new.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 寫入資料庫</span></span><br><span class="line"><span class="meta">@require_POST</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">req</span>):</span><br><span class="line">    變數_單 = <span class="keyword">class</span>名稱(</span><br><span class="line">        name=req.POST[<span class="string">&quot;name&quot;</span>],</span><br><span class="line">        description=req.POST[<span class="string">&quot;description&quot;</span>]</span><br><span class="line">    )</span><br><span class="line">    變數_單.save()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;root&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li><code>show.html</code>: 渲染到要列出單筆資料詳細內容的頁面<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; 變數_單.name &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; 變數_單.description &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="Update-更新"><a href="#Update-更新" class="headerlink" title="Update 更新"></a>Update 更新</h3><p>接下來會在 show.html 裡放上編輯按鈕，會進入更新頁面輸入內容，按下更新按鈕後回到該筆資料頁面，網址的目標設定為 <code>子目錄/編號/edit</code>：</p>
<ul>
<li><code>urls.py</code>: 新增路徑<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">app_name = <span class="string">&#x27;子目錄&#x27;</span></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&quot;&quot;</span>, views.home, name=<span class="string">&quot;index&quot;</span>) <span class="comment"># 子目錄首頁</span></span><br><span class="line">    path(<span class="string">&quot;new&quot;</span>, views.new, name=<span class="string">&quot;new&quot;</span>) <span class="comment"># 要輸入資料的頁面</span></span><br><span class="line">    path(<span class="string">&quot;add&quot;</span>, views.create, name=<span class="string">&quot;add&quot;</span>) <span class="comment"># 寫入模組</span></span><br><span class="line">    path(<span class="string">&quot;&lt;id&gt;/edit&quot;</span>, views.edit, name=<span class="string">&quot;edit&quot;</span>) <span class="comment"># 重新輸入資料的頁面</span></span><br><span class="line">    path(<span class="string">&quot;&lt;id&gt;&quot;</span>, views.show, name=<span class="string">&quot;show&quot;</span>) <span class="comment"># 單筆資料的詳細頁面</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
<li><code>edit.html</code>: 渲染到重新輸入資料的頁面<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>更新<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&#123;% url &#x27;子目錄:show&#x27; 變數_單.id %&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">	&#123;% csrf_token %&#125; </span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;name&quot;</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;name&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; 變數_單.name &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;description&quot;</span>&gt;</span>簡介<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">&quot;description&quot;</span> <span class="attr">name</span>=<span class="string">&quot;description&quot;</span>&gt;</span>&#123;&#123; 變數_單.description &#125;&#125;<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">		.</span><br><span class="line">		.</span><br><span class="line">		etc.</span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;更新&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><code>views.py</code>: 渲染路徑和程式<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, redirect get_object_or_404 <span class="comment"># 渲染路徑、轉址兼解讀路徑、判斷有無值不然就404</span></span><br><span class="line"><span class="keyword">from</span> django.views.decorators.http <span class="keyword">import</span> require_POST <span class="comment"># 判斷是不是 POST</span></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> <span class="keyword">class</span>名稱 <span class="comment"># 從同家的 model.py 取 class </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 要列出總清單的頁面</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>(<span class="params">req</span>):</span><br><span class="line">    變數_複 = <span class="keyword">class</span>名稱.objects.<span class="built_in">all</span>()</span><br><span class="line">    <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/index.html&quot;</span>, &#123;<span class="string">&quot;key&quot;</span>: 變數_複&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 要列出單筆資料詳細內容的頁面，若從編輯按鈕的 POST 進入，則會進入 if 流程</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">req, <span class="built_in">id</span></span>):</span><br><span class="line">    變數_單 = get_object_or_404(<span class="keyword">class</span>名稱, pk=<span class="built_in">id</span>) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> req.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        變數_單.name = req.POST[<span class="string">&quot;name&quot;</span>]</span><br><span class="line">        變數_單.description = req.POST[<span class="string">&quot;description&quot;</span>]</span><br><span class="line">        .</span><br><span class="line">        .</span><br><span class="line">        etc.</span><br><span class="line">        變數_單.save()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">f&quot;/子目錄/<span class="subst">&#123;變數_單.<span class="built_in">id</span>&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/show.html&quot;</span>, &#123;<span class="string">&quot;key&quot;</span>: 變數_單&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在單筆資料頁面下按下編輯按鈕時後進入的頁面</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">req, <span class="built_in">id</span></span>):</span><br><span class="line">    變數_單 = get_object_or_404(<span class="keyword">class</span>名稱, pk=<span class="built_in">id</span>) </span><br><span class="line">    <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/edit.html&quot;</span>, &#123;<span class="string">&quot;key&quot;</span>: 變數_單&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 要輸入資料的頁面</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">req</span>):</span><br><span class="line">    <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/new.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 寫入資料庫</span></span><br><span class="line"><span class="meta">@require_POST</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">req</span>):</span><br><span class="line">    變數_單 = <span class="keyword">class</span>名稱(</span><br><span class="line">        name=req.POST[<span class="string">&quot;name&quot;</span>],</span><br><span class="line">        description=req.POST[<span class="string">&quot;description&quot;</span>]</span><br><span class="line">    )</span><br><span class="line">    變數_單.save()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;root&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li><code>show.html</code>: 渲染到要列出單筆資料詳細內容的頁面<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; 變數_單.name &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; 變數_單.description &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% url &#x27;子目錄:edit&#x27; 變數_單.id %&#125;&quot;</span>&gt;</span>編輯<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="Delete-刪除"><a href="#Delete-刪除" class="headerlink" title="Delete 刪除"></a>Delete 刪除</h3><p>最後的刪除按鈕也會放在 show.html 裡，按下刪除後會連動資料苦的內容一併刪除，按下刪除按鈕後回到 index.html 總列表頁面，網址的目標設定為 <code>子目錄/編號/delete</code>：</p>
<ul>
<li><code>urls.py</code>: 新增路徑<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">app_name = <span class="string">&#x27;子目錄&#x27;</span></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&quot;&quot;</span>, views.home, name=<span class="string">&quot;index&quot;</span>) <span class="comment"># 子目錄首頁</span></span><br><span class="line">    path(<span class="string">&quot;new&quot;</span>, views.new, name=<span class="string">&quot;new&quot;</span>) <span class="comment"># 要輸入資料的頁面</span></span><br><span class="line">    path(<span class="string">&quot;add&quot;</span>, views.create, name=<span class="string">&quot;add&quot;</span>) <span class="comment"># 寫入模組</span></span><br><span class="line">    path(<span class="string">&quot;&lt;id&gt;/edit&quot;</span>, views.edit, name=<span class="string">&quot;edit&quot;</span>) <span class="comment"># 重新輸入資料的頁面</span></span><br><span class="line">    path(<span class="string">&quot;&lt;id&gt;/delete&quot;</span>, views.delete, name=<span class="string">&quot;delete&quot;</span>) <span class="comment"># 刪除後跳轉</span></span><br><span class="line">    path(<span class="string">&quot;&lt;id&gt;&quot;</span>, views.show, name=<span class="string">&quot;show&quot;</span>) <span class="comment"># 單筆資料的詳細頁面</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
<li><code>views.py</code>: 渲染路徑和程式<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, redirect, get_object_or_404 <span class="comment"># 渲染路徑、轉址兼解讀路徑、判斷有無值不然就404</span></span><br><span class="line"><span class="keyword">from</span> django.views.decorators.http <span class="keyword">import</span> require_POST <span class="comment"># 判斷是不是 POST</span></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> <span class="keyword">class</span>名稱 <span class="comment"># 從同家的 model.py 取 class </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 要列出總清單的頁面</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>(<span class="params">req</span>):</span><br><span class="line">    變數_複 = <span class="keyword">class</span>名稱.objects.<span class="built_in">all</span>()</span><br><span class="line">    <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/index.html&quot;</span>, &#123;<span class="string">&quot;key&quot;</span>: 變數_複&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 要列出單筆資料詳細內容的頁面，若從編輯按鈕的 POST 進入，則會進入 if 流程</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">req, <span class="built_in">id</span></span>):</span><br><span class="line">    變數_單 = get_object_or_404(<span class="keyword">class</span>名稱, pk=<span class="built_in">id</span>) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> req.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        變數_單.name = req.POST[<span class="string">&quot;name&quot;</span>]</span><br><span class="line">        變數_單.description = req.POST[<span class="string">&quot;description&quot;</span>]</span><br><span class="line">        .</span><br><span class="line">        .</span><br><span class="line">        etc.</span><br><span class="line">        變數_單.save()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">f&quot;/子目錄/<span class="subst">&#123;變數_單.<span class="built_in">id</span>&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/show.html&quot;</span>, &#123;<span class="string">&quot;key&quot;</span>: 變數_單&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在單筆資料頁面下按下編輯按鈕時後進入的頁面</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">req, <span class="built_in">id</span></span>):</span><br><span class="line">    變數_單 = get_object_or_404(<span class="keyword">class</span>名稱, pk=<span class="built_in">id</span>) </span><br><span class="line">    <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/edit.html&quot;</span>, &#123;<span class="string">&quot;key&quot;</span>: 變數_單&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 要輸入資料的頁面</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">req</span>):</span><br><span class="line">    <span class="keyword">return</span> render(req, <span class="string">&quot;子目錄/new.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 寫入資料庫</span></span><br><span class="line"><span class="meta">@require_POST</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">req</span>):</span><br><span class="line">    變數_單 = <span class="keyword">class</span>名稱(</span><br><span class="line">        name=req.POST[<span class="string">&quot;name&quot;</span>],</span><br><span class="line">        description=req.POST[<span class="string">&quot;description&quot;</span>]</span><br><span class="line">    )</span><br><span class="line">    變數_單.save()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;root&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 連同資料庫刪除該筆資料(硬刪)</span></span><br><span class="line"><span class="meta">@require_POST</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">req, <span class="built_in">id</span></span>):</span><br><span class="line">    變數_單 = get_object_or_404(<span class="keyword">class</span>名稱, pk=<span class="built_in">id</span>)</span><br><span class="line">    變數_單.delete()</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;子目錄:index&quot;</span>)</span><br></pre></td></tr></table></figure></li>
<li><code>show.html</code>: 渲染到要列出單筆資料詳細內容的頁面<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; 變數_單.name &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; 變數_單.description &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% url &#x27;子目錄:edit&#x27; 變數_單.id %&#125;&quot;</span>&gt;</span>編輯<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&#123;% url &#x27;子目錄:delete&#x27; 變數_單.id %&#125;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">  &#123;% csrf_token %&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span>刪除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="小結"><a href="#小結" class="headerlink" title="小結"></a>小結</h2><p>Django 起手式下篇從子目錄的建立開始介紹，我這邊指的子目錄，其實就代表一個獨立的應用程式，它們各自管理自己名下的檔案們，就不會跟其它的子目錄有衝突，我也很喜歡這種設計。接下來淺談了在 Django 環境中也可以把前端環境整合進來，但我打算將過程、實作和打包再另外寫一篇。</p>
<p>然後就開始介紹連接資料庫、table 生成和 CRUD(我真的很常把 CRUD 寫成 CRUD…好吃！)，一開始學習時覺得好多東西，但一旦了解脈絡，再加上練習，我想也能很快駕馭它。</p>

      
    </div>
    
    
    <div class="article-category">
      
      
      
        <b>Tags:</b>
        <a class="article-tag-none-link" href="../../../../tags/CRUD/" rel="tag">CRUD</a>, <a class="article-tag-none-link" href="../../../../tags/Django/" rel="tag">Django</a>, <a class="article-tag-none-link" href="../../../../tags/Tailwind/" rel="tag">Tailwind</a>
      
    </div>
    
    
  </div>
</article>

  
<nav id="article-nav" class="article-nav">
  
    <span id="article-nav-newer" class="article-nav-link-wrap newer"></span>
  
  
    <a href="../../22/%E7%94%A8%20Django%20%E5%BB%BA%E7%AB%8B%E7%B6%B2%E7%AB%99%E8%B5%B7%E6%89%8B%E5%BC%8F(%E4%B8%8A)/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">
        
          用 Django 建立網站起手式(上)
        
      </div>
    </a>
  
</nav>






    </div>
  </div>
  




<div id="settings-container">
  <div id="dark-mode">dark</div>
  <div id="sans-font">sans</div>
</div>
<script type="text/javascript">
let d=document,r=d.documentElement.style,f=r.setProperty.bind(r),l=localStorage,s=l.getItem('s')||(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches),n=l.getItem('n'),m=d.getElementById("dark-mode"),b=()=>{f('--bg-color','#fafafa');f('--code-bg-color','#f4f4f4');f('--text-color','#212121');f('--secondary-color','#808080');f('--tertiary-color','#b0b0b0');f('--link-color','#b5c8cf');f('--link-hover-color','#618794');f('--link-bg-color','#dae4e7');f('--selection-color','#dae4e7');m.innerHTML="dark"},c=()=>{f('--bg-color','#212121');f('--code-bg-color','#292929');f('--text-color','#fff');f('--secondary-color','#c0c0c0');f('--tertiary-color','#6e6e6e');f('--link-color','#4d6b75');f('--link-hover-color','#96b1bb');f('--link-bg-color','#5d828e');f('--selection-color','#acc1c9');m.innerHTML="light"},o=d.getElementById("sans-font"),e=()=>{f('--body-stack','"Lora", "Georgia", "Times New Roman", serif');o.innerHTML="sans"},g=()=>{f('--body-stack','"Lato", "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", "Verdana", sans-serif');o.innerHTML="serif"};m.onclick=()=>{if(s==2){s=1;l.setItem('s',s);c()}else{s=2;l.setItem('s',s);b()}};o.onclick=()=>{if(n==2){n=1;l.setItem('n',n);g()}else{n=2;l.setItem('n',n);e()}};if(!s){s=2;l.setItem('s',2)};if(s==1){c()};if(!n){n=2;l.setItem('n',2)};if(n==1){g()};
</script>




</body>
</html>
