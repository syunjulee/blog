---
title: 用 Django 建立網站起手式(下)
date: 2024-04-23 09:50:05
tags:
  - Django
  - CRUD
  - Tailwind
---
下篇來記錄子目錄的設定、前端環境的建立和 model 資料庫的連結與處理，整體流程上來說，通常會以 `urls -> views -> model -> render templates` 來進行。
<!-- more -->

## 專案子目錄的建立
一個子目錄是一個資料夾，也可視為一個模組，必須包含 `urls.py` 和 `views.py` 檔案，`urls.py` 是用來管理整個模組的頁面路徑結構，而 `views.py` 則是負責渲染程式到頁面的 Python 函式模組。為了每個子目錄連結都可以在全站中來去自如，需要將資料夾模組化，所以要建立 `__init__.py` 檔案。

### 在專案資料夾內新增子目錄
除了自己手動新建資料夾之外，Django 也有指令來創建：
  - `$ django-admin startproapp 資料夾名稱`
  - `$ python manage.py startapp 資料夾名稱`: 這款較可確保執行環境的穩定

  每一個透過 Django startapp 指令生成的資料夾，都可以當作一個應用程式，功能比較完整，不用再自己刻，但是接下來兩個檔案，就必須自己建立了XD。
  - `urls.py`
  經過上篇的介紹，就會知道這個檔案是用來管理入口頁的結構和路徑，而且順序很重要。
  ```py
  from django.urls import path
  from . import views

  urlpatterns = [
    path('', views.home, name='home'),
  ]
  ```
  - `views.py`
  而 views 則是負責渲染路徑的程式。
  ```py
  from django.shortcuts import render

  def home(request):
    return render(request, '對應函式名稱的 html 檔案路徑')
  ```

---
## 前端環境的設定與載入
若是想要直接在專案資料夾裡處理 CSS，在上篇有提到可以在專案資料夾下建立 static 資料夾，專門存放靜態檔案，例如 CSS、JS 和 圖片。若不使用套件，就可以很單純的加上 CSS 檔案並連結到樣版 html。
```html
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}網站名稱{% endblock %}</title>
  <link rel="stylesheet" href="{% static "styles/style.css" %}">
</head>
<body>
  {% block content %}{% endblock %}
</body>
</html>
```
但若是想要使用 CSS 套件，以 Tailwind 為例，就要從安裝前端環境開始建立：
### 在專案資料夾中安裝前端環境
首先在這個虛擬環境中建立一個 `package.json` 檔案
```md
$ node install 
$ npm install 
```
就可以安裝 CSS 套件
```md
$ npx tailwindcss init
```
init 之後會生出一個 `Tailwind.config.js` 檔案，它想知道電腦裡面有哪些檔案要用 Tailwind，沒有用到的就不會裝，可以節省容量，專有名詞叫做 Tree Shaking。
```js
/** @type {import('tailwindcss').Config} */
module.exports = {
  /* 我只有放在 templates 裡的 html 有用到 css */
  content: ["templates/**/*.html"],
  theme: {
    extend: {},
  },
  plugins: [],
}
```
### 建立 src/tailwind 資料夾，放 input.css 檔案
src/tailwind 裡的檔案是用來編譯語法的，編譯完會放在 static/styles/style.css 裡，在 src/tailwind 寫的語法，則會蓋過 static/styles/style.css 裡的語法，以達效果。
先到 `package.json` 裡的 `scripts` 欄做設定：
```js
"scripts": {
  "dev": "tailwindcss -i ./src/tailwind/style.css -o ./static/styles/style.css --watch"
  "build": "tailwindcss -i ./src/tailwind/style.css -o ./static/styles/style.css"
}
// 前：輸入地 後：輸出地
// --watch 是即時預覽
```
若是開了即時預覽，建議開三個終端機作業，一是開 Django 的本地端伺服器，二是開 node 預覽 tailwindcss 效果，三則是負責輸入一般指令。
設定完之後就可以啟動 tailwind 預覽：
```md
$ npm run dev
```
接下來若要撰寫 CSS，除了在 html 檔上加上 class，也可以到 `src/tailwind/style.css` 去寫。
```css
@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  @apply bg-red-400;
}
``` 

---
## CRUD
### Create 新增



### Read 查詢



### Update 更新



### Delete 刪除