---
title: ç”¨ Django å»ºç«‹ç¶²ç«™èµ·æ‰‹å¼(ä¸‹)
date: 2024-04-23 09:50:05
tags:
  - Django
  - CRUD
  - Tailwind
---
ä¸‹ç¯‡ä¾†è¨˜éŒ„å­ç›®éŒ„çš„è¨­å®šã€å‰ç«¯ç’°å¢ƒçš„å»ºç«‹å’Œ model è³‡æ–™åº«çš„é€£çµèˆ‡è™•ç†ï¼Œæ•´é«”æµç¨‹ä¸Šä¾†èªªï¼Œé€šå¸¸æœƒä»¥ `urls -> views -> model -> render templates` ä¾†é€²è¡Œã€‚
<!-- more -->

## å°ˆæ¡ˆå­ç›®éŒ„çš„å»ºç«‹
ä¸€å€‹å­ç›®éŒ„æ˜¯ä¸€å€‹è³‡æ–™å¤¾ï¼Œä¹Ÿå¯è¦–ç‚ºä¸€å€‹æ¨¡çµ„ï¼Œå¿…é ˆåŒ…å« `urls.py` å’Œ `views.py` æª”æ¡ˆï¼Œ`urls.py` æ˜¯ç”¨ä¾†ç®¡ç†æ•´å€‹æ¨¡çµ„çš„é é¢è·¯å¾‘çµæ§‹ï¼Œè€Œ `views.py` å‰‡æ˜¯è² è²¬æ¸²æŸ“ç¨‹å¼åˆ°é é¢çš„ Python å‡½å¼æ¨¡çµ„ã€‚ç‚ºäº†æ¯å€‹å­ç›®éŒ„é€£çµéƒ½å¯ä»¥åœ¨å…¨ç«™ä¸­ä¾†å»è‡ªå¦‚ï¼Œéœ€è¦å°‡è³‡æ–™å¤¾æ¨¡çµ„åŒ–ï¼Œæ‰€ä»¥è¦å»ºç«‹ `__init__.py` æª”æ¡ˆã€‚

### åœ¨å°ˆæ¡ˆè³‡æ–™å¤¾å…§æ–°å¢å­ç›®éŒ„
é™¤äº†è‡ªå·±æ‰‹å‹•æ–°å»ºè³‡æ–™å¤¾ä¹‹å¤–ï¼ŒDjango ä¹Ÿæœ‰æŒ‡ä»¤ä¾†å‰µå»ºï¼š
  - `$ django-admin startproapp è³‡æ–™å¤¾åç¨±`
  - `$ python manage.py startapp è³‡æ–™å¤¾åç¨±`: é€™æ¬¾è¼ƒå¯ç¢ºä¿åŸ·è¡Œç’°å¢ƒçš„ç©©å®š

  æ¯ä¸€å€‹é€é Django startapp æŒ‡ä»¤ç”Ÿæˆçš„è³‡æ–™å¤¾ï¼Œéƒ½å¯ä»¥ç•¶ä½œä¸€å€‹æ‡‰ç”¨ç¨‹å¼ï¼ŒåŠŸèƒ½æ¯”è¼ƒå®Œæ•´ï¼Œä¸ç”¨å†è‡ªå·±åˆ»ï¼Œä½†æ˜¯æ¥ä¸‹ä¾†å…©å€‹æª”æ¡ˆï¼Œå°±å¿…é ˆè‡ªå·±å»ºç«‹äº†XDã€‚
  - `urls.py`
  ç¶“éä¸Šç¯‡çš„ä»‹ç´¹ï¼Œå°±æœƒçŸ¥é“é€™å€‹æª”æ¡ˆæ˜¯ç”¨ä¾†ç®¡ç†å…¥å£é çš„çµæ§‹å’Œè·¯å¾‘ï¼Œè€Œä¸”é †åºå¾ˆé‡è¦ã€‚
  ```py
  from django.urls import path
  from . import views

  app_name = 'å­ç›®éŒ„'

  urlpatterns = [
    path('', views.home, name='home'),
  ]
  ```
  - `views.py`
  è€Œ views å‰‡æ˜¯è² è²¬æ¸²æŸ“è·¯å¾‘çš„ç¨‹å¼ã€‚
  ```py
  from django.shortcuts import render

  def home(req):
    return render(req, 'å­ç›®éŒ„/index.html')
  ```

---
## å‰ç«¯ç’°å¢ƒçš„è¨­å®šèˆ‡è¼‰å…¥
è‹¥æ˜¯æƒ³è¦ç›´æ¥åœ¨å°ˆæ¡ˆè³‡æ–™å¤¾è£¡è™•ç† CSSï¼Œåœ¨ä¸Šç¯‡æœ‰æåˆ°å¯ä»¥åœ¨å°ˆæ¡ˆè³‡æ–™å¤¾ä¸‹å»ºç«‹ static è³‡æ–™å¤¾ï¼Œå°ˆé–€å­˜æ”¾éœæ…‹æª”æ¡ˆï¼Œä¾‹å¦‚ CSSã€JS å’Œ åœ–ç‰‡ã€‚è‹¥ä¸ä½¿ç”¨å¥—ä»¶ï¼Œå°±å¯ä»¥å¾ˆå–®ç´”çš„åŠ ä¸Š CSS æª”æ¡ˆä¸¦é€£çµåˆ°æ¨£ç‰ˆ htmlã€‚
```html
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}ç¶²ç«™åç¨±{% endblock %}</title>
  <link rel="stylesheet" href="{% static "styles/style.css" %}">
</head>
<body>
  {% block content %}{% endblock %}
</body>
</html>
```
è©³ç´°çš„å‰ç«¯å·¥å…·è¼‰å…¥èˆ‡è¨­å®šæœƒåœ¨ JS æ‰“åŒ…ç¯‡è©³è§£ï½

---
## åœ¨ Django èˆ‡è³‡æ–™åº«é€£çµ
åœ¨ html è£½ä½œè¦èˆ‡è³‡æ–™åº«é€£å‹•çš„è¡¨å–®(form)ï¼Œæœ‰å…©å€‹è·Ÿè³‡æ–™åº«æœ‰é—œçš„å±¬æ€§ï¼šaction å’Œ method
```html
<form action="æŠŠè³‡æ–™é€å»å“ªè£¡" method="ç”¨ä»€éº¼æ–¹æ³•é€"></form>
```
action çš„å€¼æ˜¯ä¸€å€‹ç¶²é è·¯å¾‘ï¼Œæ˜¯æŒ‡é€™å€‹è¡¨å–®çš„å…§å®¹åœ¨å•Ÿå‹•è§¸ç™¼å™¨æ™‚ï¼ŒæœƒæŠŠè³‡æ–™é€å»å“ªè£¡è™•ç†ï¼›method çš„å€¼å‰‡æ˜¯é¸æ“‡ç”¨ä»€éº¼æ–¹æ³•é€å»ï¼Œç›®å‰ html åªæœ‰å…©ç¨®æ–¹æ³•ï¼šGET å’Œ POSTã€‚
  - GET: ç¶²å€æœƒæŠŠè¼¸å…¥è³‡æ–™é¡¯ç¤ºåœ¨ç¶²å€ä¸Šï¼Œç¨±ä½œ QueryStringï¼Œç”¨åœ¨æŸ¥è©¢æˆ–æœå°‹æ¯”è¼ƒå¥½
  - POST: åä¹‹ï¼Œç¶²å€æœƒæŠŠè¼¸å…¥è³‡æ–™éš±è—ï¼Œè³‡æ–™æœƒåœ¨ request ç‰©ä»¶è£¡çš„ bodyï¼Œæ’ˆè³‡æ–™ä¹Ÿæ˜¯å¾é€™è£¡ï¼Œä½†è‡³å°‘åœ¨å‰å°ä¸æœƒé¡¯ç¤ºï¼Œåƒæ˜¯æ–°å¢ã€æ›´æ–°å’Œåˆªé™¤ç­‰æ“ä½œç”¨ POST æœƒè¼ƒåˆé©ã€‚


---
### `model.py` ç”Ÿæˆè³‡æ–™åº«
è¦å…ˆåœ¨ Django å°ˆæ¡ˆè³‡æ–™å¤¾è£¡ç”Ÿæˆè³‡æ–™åº«ï¼Œå°±å¯ä»¥ç›´æ¥åœ¨å°ˆæ¡ˆè³‡æ–™å¤¾è£¡ç”Ÿæˆæ“ä½œè³‡æ–™è¡¨(table)ã€‚ç”¨ ORM(Object-Relationship Mapping ç‰©ä»¶é—œè¯æ€§å°ç…§)å¯«å…¥è³‡æ–™æˆ–è®€å–åœ¨å­ç›®éŒ„ä¸‹çš„ model.pyã€‚
```py
from django.db import models

class Name(models.Model):
    name = models.CharField(max-length=100)
    description = models.TextField(max-length=200)
    create_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
    .
    .
    etc.
```
å»ºå®Œæ¨¡çµ„å¾Œï¼Œè¨˜å¾—ä¹Ÿè¦å» `settings.py` è¨»å†Š APPã€‚
å¢åŠ å®Œä¹‹å¾Œç”¨ Django æŒ‡ä»¤ç”Ÿæˆè³‡æ–™è¡¨å’Œæ¬„ä½ï¼š
```md
$ python manage.py makemigrations
```
ç”Ÿæˆä¸€å€‹ migrations/0001.initial.py çµ¦å­ç›®éŒ„ï¼Œä½†ç›®å‰åªæ˜¯ç”Ÿæˆï¼Œé‚„è¦å» Apply å®ƒï¼Œæ‰€ä»¥
```md
$ python manage.py migrate
```
å°±æœƒç”¢ç”Ÿå¾ `model.py` å¯«å¥½çš„æ¨¡çµ„å»ºæˆè³‡æ–™åº«æª”æ¡ˆï¼Œè€Œ table çš„åç¨±å°±æœƒå«åš `å­ç›®éŒ„_classåç¨±`ã€‚è‹¥è¦æ›´æ–°ä¿®æ”¹æ¨¡çµ„æª”æ¡ˆï¼Œé‚„æ˜¯è¦å†è·‘ä¸Šè¿°å…©å€‹æŒ‡ä»¤ã€‚å¦å¤–ï¼Œé‚„å¯ä»¥æŒ‡å®šè¦å›åˆ°å“ªæ¢ migrationï¼Œä½†æ˜¯è©²æ¢æ‰€åšçš„å…§å®¹ä¹Ÿæœƒè·Ÿè‘—æ¶ˆå¤±ï¼Œé›–ç„¶æœ‰ç‰ˆæ§çš„æ„Ÿè¦ºï¼Œä½†å€’é€€åš•é‚„æ˜¯æœƒæœ‰ä¸€å®šçš„é¢¨éšªåœ¨ï¼Œé›–ç„¶å†åŸ·è¡Œä¸€æ¬¡ `migrate` è³‡æ–™çµæ§‹æœƒå›ä¾†ï¼Œä½†å…§å®¹å»æœƒæ°¸é æ¶ˆå¤±ã€‚


---
## CRUD
æ¥ä¸‹ä¾†é–‹å§‹è³‡æ–™åº«æœ€åŸºæœ¬çš„æ“ä½œï¼Œå°±æ˜¯ CRUDï¼Œåˆ†åˆ¥æ˜¯ Create æ–°å¢å‰µå»ºã€Read æŸ¥è©¢æœå°‹é¡¯ç¤ºã€Update æ›´æ–°è³‡æ–™ã€Delete åˆªé™¤è³‡æ–™ã€‚ä»¥ä¸‹æ˜¯åœ¨ Django æ¡†æ¶ä¸‹æ“ä½œ CRUD çš„ç·´ç¿’å’Œå¿ƒå¾—ï¼Œåœ¨ Django æ“ä½œ CRUDï¼Œå¿…é ˆåŒæ™‚è™•ç†ä¸‰å€‹æª”æ¡ˆï¼Œåˆ†åˆ¥æ˜¯ `urls.py`ã€`views.py` å’Œ `html`ï¼Œé‚£æˆ‘å€‘å°±ç¹¼çºŒçœ‹ä¸‹å»ï½ğŸ˜„


---
### Create æ–°å¢
  - `urls.py`: æ–°å¢è·¯å¾‘
```py
from django.urls import path
from . import views

app_name = 'å­ç›®éŒ„'

urlpatterns = [
    path("", views.home, name="index") # å­ç›®éŒ„é¦–é 
    path("new", views.new, name="new") # è¦è¼¸å…¥è³‡æ–™çš„é é¢
    path("add", views.create, name="add") # å¯«å…¥æ¨¡çµ„
]
```
  - `views.py`: æ¸²æŸ“è·¯å¾‘å’Œç¨‹å¼
```py
from django.shortcuts import render, redirect # æ¸²æŸ“è·¯å¾‘ã€è½‰å€å…¼è§£è®€è·¯å¾‘
from django.views.decorators.http import require_POST # åˆ¤æ–·æ˜¯ä¸æ˜¯ POST
from .models import classåç¨± # å¾åŒå®¶çš„ model å– class 

# è¦è¼¸å…¥è³‡æ–™çš„é é¢
def new(req):
    return render(req, "å­ç›®éŒ„/new.html")

# å¯«å…¥è³‡æ–™åº«
@require_POST
def create(req):
    è®Šæ•¸_å–® = classåç¨±(
        name=req.POST["name"],
        description=req.POST["description"]
    )
    è®Šæ•¸_å–®.save()
        
    return redirect("root")
```
  - `new.html`: æ¸²æŸ“åˆ°è¼¸å…¥è³‡æ–™çš„é é¢
```html
<h1>æ–°å¢</h1>
<form action="{% url 'å­ç›®éŒ„:add' %}" method="post">
  <!-- ä½¿ç”¨ POST æ–¹æ³•æ™‚çš„å®‰å…¨é©—è­‰æ©Ÿåˆ¶ -->
	{% csrf_token %} 
	
	<div>
		<label for="name">å§“å</label>
		<input type="text" id="name" name="name">
		
		<label for="description">ç°¡ä»‹</label>
		<textarea id="description" name="description"></textarea>
		.
		.
		etc.
	</div>
	
	<input type="submit" value="æ–°å¢">
</form>
```

---
### Read æŸ¥è©¢
æŸ¥è©¢æœ‰å…©ä»¶äº‹è¦åšï¼š
1. åœ¨å­ç›®éŒ„é¦–é æª¢è¦–ç¸½åˆ—è¡¨(index)
2. é»æ“Šç¸½åˆ—è¡¨å…§å®¹å¾Œæœƒé€£åˆ°è©³ç´°è³‡æ–™é é¢å»(show)

---
è¦åœ¨å­ç›®éŒ„çš„ index.html ä¸­åˆ—å‡ºæ¸…å–®ï¼Œæœƒç”¨ `class.object.all()` ä¾†åˆ—å‡ºï¼š
  - `views.py`: æ¸²æŸ“è·¯å¾‘å’Œç¨‹å¼
```py
from django.shortcuts import render, redirect # æ¸²æŸ“è·¯å¾‘ã€è½‰å€å…¼è§£è®€è·¯å¾‘
from django.views.decorators.http import require_POST # åˆ¤æ–·æ˜¯ä¸æ˜¯ POST
from .models import classåç¨± # å¾åŒå®¶çš„ model.py å– class 

# è¦åˆ—å‡ºç¸½æ¸…å–®çš„é é¢
def index(req):
    è®Šæ•¸_è¤‡ = classåç¨±.objects.all()
    return render(req, "å­ç›®éŒ„/index.html", {"key": è®Šæ•¸_è¤‡})
    
# è¦è¼¸å…¥è³‡æ–™çš„é é¢
def new(req):
    return render(req, "å­ç›®éŒ„/new.html")

# å¯«å…¥è³‡æ–™åº«
@require_POST
def create(req):
    è®Šæ•¸_å–® = classåç¨±(
        name=req.POST["name"],
        description=req.POST["description"]
    )
    è®Šæ•¸_å–®.save()
        
    return redirect("root")
```
  - `index.html`: æ¸²æŸ“åˆ°è¦åˆ—å‡ºç¸½æ¸…å–®çš„é é¢
```html
<h1>ç¸½åˆ—è¡¨</h1>
<!-- å‰å¾€æ–°å¢çš„é é¢ -->
<a href="{% url 'å­ç›®éŒ„:new' %}">æ–°å¢</a> 
<!-- ç”¨è¿´åœˆæ¸²æŸ“å‡ºç¸½åˆ—è¡¨ -->
{% for è®Šæ•¸_å–® in è®Šæ•¸_è¤‡ %}
	<!-- è¨­è¨ˆå¡ç‰‡å›‰ï½ -->
	<div>
    <!-- æ¸²æŸ“å‡ºåç¨± -->
		{{ è®Šæ•¸_å–®.name }} 
	</div>
{% endfor %}
```

---
ç¬¬äºŒå€‹æ˜¯é»æ“Šå…§å®¹æœƒé€£å»è©²ç­†è³‡æ–™çš„è©³ç´°é é¢ï¼Œç¶²å€çš„ç›®æ¨™è¨­å®šç‚º `å­ç›®éŒ„/ç·¨è™Ÿ`ï¼š
  - `urls.py`: æ–°å¢è·¯å¾‘
```py
from django.urls import path
from . import views

app_name = 'å­ç›®éŒ„'

urlpatterns = [
    path("", views.index, name="index") # å­ç›®éŒ„é¦–é 
    path("new", views.new, name="new") # è¦è¼¸å…¥è³‡æ–™çš„é é¢
    path("add", views.create, name="add") # å¯«å…¥æ¨¡çµ„

    # ç¶²å€æ‡‰è©²æ˜¯ä¸€å€‹è®Šå‹•çš„è®Šæ•¸ï¼Œæ‰€ä»¥è¦ç”¨<>åŒ…ä½ï¼Œè€Œä¸”é †åºéå¸¸é‡è¦ï¼Œè®“æ¯”å°æ€§çš„è®Šæ•¸ç¶²å€æ”¾åœ¨æœ€å¾Œï¼Œæ‰ä¸æœƒè®“å…¶ä»–ç¶²å€è®Šæˆè®Šæ•¸çš„å€¼
    path("<id>", views.show, name="show") # å–®ç­†è³‡æ–™çš„è©³ç´°é é¢
]
``` 
  - `views.py`: æ¸²æŸ“è·¯å¾‘å’Œç¨‹å¼
```py
from django.shortcuts import render, redirect get_object_or_404 # æ¸²æŸ“è·¯å¾‘ã€è½‰å€å…¼è§£è®€è·¯å¾‘ã€åˆ¤æ–·æœ‰ç„¡å€¼ä¸ç„¶å°±404
from django.views.decorators.http import require_POST # åˆ¤æ–·æ˜¯ä¸æ˜¯ POST
from .models import classåç¨± # å¾åŒå®¶çš„ model.py å– class 

# è¦åˆ—å‡ºç¸½æ¸…å–®çš„é é¢
def index(req):
    è®Šæ•¸_è¤‡ = classåç¨±.objects.all()
    return render(req, "å­ç›®éŒ„/index.html", {"key": è®Šæ•¸_è¤‡})

# è¦åˆ—å‡ºå–®ç­†è³‡æ–™è©³ç´°å…§å®¹çš„é é¢
def show(req, id):
    # ç‚ºäº†é˜²æ­¢ä½¿ç”¨è€…åœ¨ QueryString è‡ªå·±äº‚æ‰¾ç·¨è™Ÿï¼Œè¦åšä¸€å€‹é˜²æ­¢æªæ–½
    è®Šæ•¸_å–® = get_object_or_404(classåç¨±, pk=id) # ä¸»éµæ˜¯ id
    return render(req, "å­ç›®éŒ„/show.html", {"key": è®Šæ•¸_å–®})

# è¦è¼¸å…¥è³‡æ–™çš„é é¢
def new(req):
    return render(req, "å­ç›®éŒ„/new.html")

# å¯«å…¥è³‡æ–™åº«
@require_POST
def create(req):
    è®Šæ•¸_å–® = classåç¨±(
        name=req.POST["name"],
        description=req.POST["description"]
    )
    è®Šæ•¸_å–®.save()
        
    return redirect("root")
```
  - `show.html`: æ¸²æŸ“åˆ°è¦åˆ—å‡ºå–®ç­†è³‡æ–™è©³ç´°å…§å®¹çš„é é¢
```html
<h1>{{ è®Šæ•¸_å–®.name }}</h1>
<p>{{ è®Šæ•¸_å–®.description }}</p>
```


---
### Update æ›´æ–°
æ¥ä¸‹ä¾†æœƒåœ¨ show.html è£¡æ”¾ä¸Šç·¨è¼¯æŒ‰éˆ•ï¼Œæœƒé€²å…¥æ›´æ–°é é¢è¼¸å…¥å…§å®¹ï¼ŒæŒ‰ä¸‹æ›´æ–°æŒ‰éˆ•å¾Œå›åˆ°è©²ç­†è³‡æ–™é é¢ï¼Œç¶²å€çš„ç›®æ¨™è¨­å®šç‚º `å­ç›®éŒ„/ç·¨è™Ÿ/edit`ï¼š
  - `urls.py`: æ–°å¢è·¯å¾‘
```py
from django.urls import path
from . import views

app_name = 'å­ç›®éŒ„'

urlpatterns = [
    path("", views.home, name="index") # å­ç›®éŒ„é¦–é 
    path("new", views.new, name="new") # è¦è¼¸å…¥è³‡æ–™çš„é é¢
    path("add", views.create, name="add") # å¯«å…¥æ¨¡çµ„
    path("<id>/edit", views.edit, name="edit") # é‡æ–°è¼¸å…¥è³‡æ–™çš„é é¢
    path("<id>", views.show, name="show") # å–®ç­†è³‡æ–™çš„è©³ç´°é é¢
]
```
  - `edit.html`: æ¸²æŸ“åˆ°é‡æ–°è¼¸å…¥è³‡æ–™çš„é é¢
```html
<h1>æ›´æ–°</h1>
<form action="{% url 'å­ç›®éŒ„:show' è®Šæ•¸_å–®.id %}" method="post">
	{% csrf_token %} 
	
	<div>
		<label for="name">å§“å</label>
		<input type="text" id="name" name="name" value="{{ è®Šæ•¸_å–®.name }}">
		
		<label for="description">ç°¡ä»‹</label>
		<textarea id="description" name="description">{{ è®Šæ•¸_å–®.description }}</textarea>
		.
		.
		etc.
	</div>
	
	<input type="submit" value="æ›´æ–°">
</form>
```
  - `views.py`: æ¸²æŸ“è·¯å¾‘å’Œç¨‹å¼
```py
from django.shortcuts import render, redirect get_object_or_404 # æ¸²æŸ“è·¯å¾‘ã€è½‰å€å…¼è§£è®€è·¯å¾‘ã€åˆ¤æ–·æœ‰ç„¡å€¼ä¸ç„¶å°±404
from django.views.decorators.http import require_POST # åˆ¤æ–·æ˜¯ä¸æ˜¯ POST
from .models import classåç¨± # å¾åŒå®¶çš„ model.py å– class 

# è¦åˆ—å‡ºç¸½æ¸…å–®çš„é é¢
def index(req):
    è®Šæ•¸_è¤‡ = classåç¨±.objects.all()
    return render(req, "å­ç›®éŒ„/index.html", {"key": è®Šæ•¸_è¤‡})

# è¦åˆ—å‡ºå–®ç­†è³‡æ–™è©³ç´°å…§å®¹çš„é é¢ï¼Œè‹¥å¾ç·¨è¼¯æŒ‰éˆ•çš„ POST é€²å…¥ï¼Œå‰‡æœƒé€²å…¥ if æµç¨‹
def show(req, id):
    è®Šæ•¸_å–® = get_object_or_404(classåç¨±, pk=id) 

    if req.method == "POST":
        è®Šæ•¸_å–®.name = req.POST["name"]
        è®Šæ•¸_å–®.description = req.POST["description"]
        .
        .
        etc.
        è®Šæ•¸_å–®.save()

        return redirect(f"/å­ç›®éŒ„/{è®Šæ•¸_å–®.id}")
    else:
        return render(req, "å­ç›®éŒ„/show.html", {"key": è®Šæ•¸_å–®})

# åœ¨å–®ç­†è³‡æ–™é é¢ä¸‹æŒ‰ä¸‹ç·¨è¼¯æŒ‰éˆ•æ™‚å¾Œé€²å…¥çš„é é¢
def edit(req, id):
    è®Šæ•¸_å–® = get_object_or_404(classåç¨±, pk=id) 
    return render(req, "å­ç›®éŒ„/edit.html", {"key": è®Šæ•¸_å–®})

# è¦è¼¸å…¥è³‡æ–™çš„é é¢
def new(req):
    return render(req, "å­ç›®éŒ„/new.html")

# å¯«å…¥è³‡æ–™åº«
@require_POST
def create(req):
    è®Šæ•¸_å–® = classåç¨±(
        name=req.POST["name"],
        description=req.POST["description"]
    )
    è®Šæ•¸_å–®.save()
        
    return redirect("root")
```
  - `show.html`: æ¸²æŸ“åˆ°è¦åˆ—å‡ºå–®ç­†è³‡æ–™è©³ç´°å…§å®¹çš„é é¢
```html
<h1>{{ è®Šæ•¸_å–®.name }}</h1>
<p>{{ è®Šæ•¸_å–®.description }}</p>

<a href="{% url 'å­ç›®éŒ„:edit' è®Šæ•¸_å–®.id %}">ç·¨è¼¯</a>
```


---
### Delete åˆªé™¤
æœ€å¾Œçš„åˆªé™¤æŒ‰éˆ•ä¹Ÿæœƒæ”¾åœ¨ show.html è£¡ï¼ŒæŒ‰ä¸‹åˆªé™¤å¾Œæœƒé€£å‹•è³‡æ–™è‹¦çš„å…§å®¹ä¸€ä½µåˆªé™¤ï¼ŒæŒ‰ä¸‹åˆªé™¤æŒ‰éˆ•å¾Œå›åˆ° index.html ç¸½åˆ—è¡¨é é¢ï¼Œç¶²å€çš„ç›®æ¨™è¨­å®šç‚º `å­ç›®éŒ„/ç·¨è™Ÿ/delete`ï¼š
  - `urls.py`: æ–°å¢è·¯å¾‘
```py
from django.urls import path
from . import views

app_name = 'å­ç›®éŒ„'

urlpatterns = [
    path("", views.home, name="index") # å­ç›®éŒ„é¦–é 
    path("new", views.new, name="new") # è¦è¼¸å…¥è³‡æ–™çš„é é¢
    path("add", views.create, name="add") # å¯«å…¥æ¨¡çµ„
    path("<id>/edit", views.edit, name="edit") # é‡æ–°è¼¸å…¥è³‡æ–™çš„é é¢
    path("<id>/delete", views.delete, name="delete") # åˆªé™¤å¾Œè·³è½‰
    path("<id>", views.show, name="show") # å–®ç­†è³‡æ–™çš„è©³ç´°é é¢
]
```
  - `views.py`: æ¸²æŸ“è·¯å¾‘å’Œç¨‹å¼
```py
from django.shortcuts import render, redirect, get_object_or_404 # æ¸²æŸ“è·¯å¾‘ã€è½‰å€å…¼è§£è®€è·¯å¾‘ã€åˆ¤æ–·æœ‰ç„¡å€¼ä¸ç„¶å°±404
from django.views.decorators.http import require_POST # åˆ¤æ–·æ˜¯ä¸æ˜¯ POST
from .models import classåç¨± # å¾åŒå®¶çš„ model.py å– class 

# è¦åˆ—å‡ºç¸½æ¸…å–®çš„é é¢
def index(req):
    è®Šæ•¸_è¤‡ = classåç¨±.objects.all()
    return render(req, "å­ç›®éŒ„/index.html", {"key": è®Šæ•¸_è¤‡})

# è¦åˆ—å‡ºå–®ç­†è³‡æ–™è©³ç´°å…§å®¹çš„é é¢ï¼Œè‹¥å¾ç·¨è¼¯æŒ‰éˆ•çš„ POST é€²å…¥ï¼Œå‰‡æœƒé€²å…¥ if æµç¨‹
def show(req, id):
    è®Šæ•¸_å–® = get_object_or_404(classåç¨±, pk=id) 

    if req.method == "POST":
        è®Šæ•¸_å–®.name = req.POST["name"]
        è®Šæ•¸_å–®.description = req.POST["description"]
        .
        .
        etc.
        è®Šæ•¸_å–®.save()

        return redirect(f"/å­ç›®éŒ„/{è®Šæ•¸_å–®.id}")
    else:
        return render(req, "å­ç›®éŒ„/show.html", {"key": è®Šæ•¸_å–®})

# åœ¨å–®ç­†è³‡æ–™é é¢ä¸‹æŒ‰ä¸‹ç·¨è¼¯æŒ‰éˆ•æ™‚å¾Œé€²å…¥çš„é é¢
def edit(req, id):
    è®Šæ•¸_å–® = get_object_or_404(classåç¨±, pk=id) 
    return render(req, "å­ç›®éŒ„/edit.html", {"key": è®Šæ•¸_å–®})

# è¦è¼¸å…¥è³‡æ–™çš„é é¢
def new(req):
    return render(req, "å­ç›®éŒ„/new.html")

# å¯«å…¥è³‡æ–™åº«
@require_POST
def create(req):
    è®Šæ•¸_å–® = classåç¨±(
        name=req.POST["name"],
        description=req.POST["description"]
    )
    è®Šæ•¸_å–®.save()
        
    return redirect("root")

# é€£åŒè³‡æ–™åº«åˆªé™¤è©²ç­†è³‡æ–™(ç¡¬åˆª)
@require_POST
def delete(req, id):
    è®Šæ•¸_å–® = get_object_or_404(classåç¨±, pk=id)
    è®Šæ•¸_å–®.delete()
    return redirect("å­ç›®éŒ„:index")
```
  - `show.html`: æ¸²æŸ“åˆ°è¦åˆ—å‡ºå–®ç­†è³‡æ–™è©³ç´°å…§å®¹çš„é é¢
```html
<h1>{{ è®Šæ•¸_å–®.name }}</h1>
<p>{{ è®Šæ•¸_å–®.description }}</p>

<a href="{% url 'å­ç›®éŒ„:edit' è®Šæ•¸_å–®.id %}">ç·¨è¼¯</a>

<form action="{% url 'å­ç›®éŒ„:delete' è®Šæ•¸_å–®.id %}" method="post">
  {% csrf_token %}
  <button>åˆªé™¤</button>
</form>
```


---
## å°çµ
Django èµ·æ‰‹å¼ä¸‹ç¯‡å¾å­ç›®éŒ„çš„å»ºç«‹é–‹å§‹ä»‹ç´¹ï¼Œæˆ‘é€™é‚ŠæŒ‡çš„å­ç›®éŒ„ï¼Œå…¶å¯¦å°±ä»£è¡¨ä¸€å€‹ç¨ç«‹çš„æ‡‰ç”¨ç¨‹å¼ï¼Œå®ƒå€‘å„è‡ªç®¡ç†è‡ªå·±åä¸‹çš„æª”æ¡ˆå€‘ï¼Œå°±ä¸æœƒè·Ÿå…¶å®ƒçš„å­ç›®éŒ„æœ‰è¡çªï¼Œæˆ‘ä¹Ÿå¾ˆå–œæ­¡é€™ç¨®è¨­è¨ˆã€‚æ¥ä¸‹ä¾†æ·ºè«‡äº†åœ¨ Django ç’°å¢ƒä¸­ä¹Ÿå¯ä»¥æŠŠå‰ç«¯ç’°å¢ƒæ•´åˆé€²ä¾†ï¼Œä½†æˆ‘æ‰“ç®—å°‡éç¨‹ã€å¯¦ä½œå’Œæ‰“åŒ…å†å¦å¤–å¯«ä¸€ç¯‡ã€‚

ç„¶å¾Œå°±é–‹å§‹ä»‹ç´¹é€£æ¥è³‡æ–™åº«ã€table ç”Ÿæˆå’Œ CRUD(æˆ‘çœŸçš„å¾ˆå¸¸æŠŠ CRUD å¯«æˆ CRUD...å¥½åƒï¼)ï¼Œä¸€é–‹å§‹å­¸ç¿’æ™‚è¦ºå¾—å¥½å¤šæ±è¥¿ï¼Œä½†ä¸€æ—¦äº†è§£è„ˆçµ¡ï¼Œå†åŠ ä¸Šç·´ç¿’ï¼Œæˆ‘æƒ³ä¹Ÿèƒ½å¾ˆå¿«é§•é¦­å®ƒã€‚